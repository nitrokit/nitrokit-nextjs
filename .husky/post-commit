#!/bin/sh
# .husky/post-commit

echo 'ðŸ”’ Sanitizing .env file after successful commit...'

# .env dosyasÄ± var mÄ± kontrol et
if [ ! -f .env ]; then
    echo 'âš ï¸  .env file not found, skipping sanitization'
    exit 0
fi

# .env.example dosyasÄ± oluÅŸtur/gÃ¼ncelle
echo 'ðŸ“ Creating/updating .env.example with sanitized values...'

# FarklÄ± deÄŸiÅŸken tÃ¼rleri iÃ§in Ã¶zel Ã¶rnek deÄŸerler
cat .env | while IFS='=' read -r key value; do
    # BoÅŸ satÄ±rlarÄ± atla
    if [ -z "$key" ]; then
        echo ""
        continue
    fi
    
    # Yorum satÄ±rlarÄ±nÄ± koru
    if echo "$key" | grep -q '^#'; then
        echo "$key"
        continue
    fi
    
    # DeÄŸiÅŸken adÄ±na gÃ¶re Ã¶zel Ã¶rnek deÄŸerler
    case "$key" in
        *API_KEY*|*SECRET*|*TOKEN*|*PASSWORD*)
            echo "${key}=---$(echo ${key} | tr '[:upper:]' '[:lower:]')---"
            ;;
        *URL*|*ENDPOINT*)
            echo "${key}=https://example.com/api"
            ;;
        *PORT*)
            echo "${key}=3000"
            ;;
        *DATABASE*|*DB*)
            echo "${key}=postgresql://user:password@localhost:5432/database"
            ;;
        *EMAIL*)
            echo "${key}=noreply@example.com"
            ;;
        *DOMAIN*|*HOST*)
            echo "${key}=localhost"
            ;;
        *DEBUG*|*LOG*|*VERBOSE*)
            echo "${key}=false"
            ;;
        *ENV*|*NODE_ENV*)
            echo "${key}=development"
            ;;
        *)
            echo "${key}=---example-value---"
            ;;
    esac
done > .env.example

echo 'âœ… .env.example created/updated with sanitized values'
echo 'ðŸŽ‰ Environment file sanitization completed!'
